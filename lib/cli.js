"use strict";
/**
 * Created by user on 2019/5/17.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const yargs = require("yargs");
const cached_command = {};
exports.cli = yargs
    .option('cwd', {
    desc: `current working directory or package directory`,
    normalize: true,
    default: process.cwd(),
})
    .option('skipCheckWorkspace', {
    desc: `this options is for search yarn.lock, pkg root, workspace root, not same as --ignore-workspace-root-check`,
    boolean: true,
})
    .option('yt-debug-mode', {
    boolean: true,
})
    .command({
    command: 'help',
    describe: 'Show help',
    aliases: ['h'],
    builder(yarg) {
        yarg.showHelp('log');
        return yarg;
    },
    handler: dummy_handler,
})
    .command({
    command: 'version',
    describe: 'Show version',
    builder(yarg) {
        return yarg;
    },
    async handler() {
        return Promise.resolve().then(() => require('../package.json')).then(v => console.log(v.version));
    },
})
    .recommendCommands();
function getYargs() {
    // @ts-ignore
    return exports.cli;
}
exports.getYargs = getYargs;
exports.default = exports.cli;
function dummy_builder(yarg) {
    return yarg;
}
exports.dummy_builder = dummy_builder;
function dummy_handler(args) {
    return args;
}
exports.dummy_handler = dummy_handler;
function create_command(yarg, command, handler, builder) {
    // @ts-ignore
    builder = builder || dummy_builder;
    cached_command[command] = {
        // @ts-ignore
        builder,
        // @ts-ignore
        handler,
    };
    return [builder, handler];
}
exports.create_command = create_command;
function call_commond(yarg, commond, argv) {
    return cached_command[commond].handler(argv == null ? yarg.argv : argv);
}
exports.call_commond = call_commond;
function create_command2(conf) {
    // @ts-ignore
    let { handler = dummy_handler, builder = dummy_builder, desc } = conf;
    let { describe = desc } = conf;
    let opts = {
        ...conf,
        // @ts-ignore
        builder,
        handler,
        describe,
    };
    let command;
    if (Array.isArray(command)) {
        let cmd = command[0];
        cached_command[cmd] = opts;
        command.slice(1).forEach(c => cached_command[c] = cached_command[cmd]);
    }
    else {
        cached_command[command] = opts;
    }
    _delete(opts);
    function _delete(opts) {
        // @ts-ignore
        delete opts.yarg;
        delete opts.desc;
    }
    return opts;
}
exports.create_command2 = create_command2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2xpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCwrQkFBZ0M7QUFHaEMsTUFBTSxjQUFjLEdBQW1CLEVBQUUsQ0FBQztBQUU3QixRQUFBLEdBQUcsR0FBRyxLQUFLO0tBQ3RCLE1BQU0sQ0FBQyxLQUFLLEVBQUU7SUFDZCxJQUFJLEVBQUUsZ0RBQWdEO0lBQ3RELFNBQVMsRUFBRSxJQUFJO0lBQ2YsT0FBTyxFQUFFLE9BQU8sQ0FBQyxHQUFHLEVBQUU7Q0FDdEIsQ0FBQztLQUNELE1BQU0sQ0FBQyxvQkFBb0IsRUFBRTtJQUM3QixJQUFJLEVBQUUsMkdBQTJHO0lBQ2pILE9BQU8sRUFBRSxJQUFJO0NBQ2IsQ0FBQztLQUNELE1BQU0sQ0FBQyxlQUFlLEVBQUU7SUFDeEIsT0FBTyxFQUFFLElBQUk7Q0FDYixDQUFDO0tBQ0QsT0FBTyxDQUFDO0lBQ1IsT0FBTyxFQUFFLE1BQU07SUFDZixRQUFRLEVBQUUsV0FBVztJQUNyQixPQUFPLEVBQUUsQ0FBQyxHQUFHLENBQUM7SUFDZCxPQUFPLENBQUMsSUFBSTtRQUVYLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckIsT0FBTyxJQUFJLENBQUM7SUFDYixDQUFDO0lBQ0QsT0FBTyxFQUFFLGFBQWE7Q0FDdEIsQ0FBQztLQUNELE9BQU8sQ0FBQztJQUNSLE9BQU8sRUFBRSxTQUFTO0lBQ2xCLFFBQVEsRUFBRSxjQUFjO0lBQ3hCLE9BQU8sQ0FBQyxJQUFJO1FBRVgsT0FBTyxJQUFJLENBQUM7SUFDYixDQUFDO0lBQ0QsS0FBSyxDQUFDLE9BQU87UUFFWixPQUFPLHFDQUFPLGlCQUFpQixHQUM3QixJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUNqQztJQUNILENBQUM7Q0FDRCxDQUFDO0tBQ0QsaUJBQWlCLEVBQUUsQ0FDcEI7QUFTRCxTQUFnQixRQUFRO0lBRXZCLGFBQWE7SUFDYixPQUFPLFdBQUcsQ0FBQztBQUNaLENBQUM7QUFKRCw0QkFJQztBQUVELGtCQUFlLFdBQUcsQ0FBQTtBQVNsQixTQUFnQixhQUFhLENBQWUsSUFBbUI7SUFFOUQsT0FBTyxJQUFJLENBQUE7QUFDWixDQUFDO0FBSEQsc0NBR0M7QUFFRCxTQUFnQixhQUFhLENBQWUsSUFBd0I7SUFFbkUsT0FBTyxJQUFJLENBQUE7QUFDWixDQUFDO0FBSEQsc0NBR0M7QUFFRCxTQUFnQixjQUFjLENBQWlCLElBQW1CLEVBQ2pFLE9BQWUsRUFDZixPQUEyQyxFQUMzQyxPQUFnRDtJQUdoRCxhQUFhO0lBQ2IsT0FBTyxHQUFHLE9BQU8sSUFBSSxhQUFhLENBQUM7SUFFbkMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxHQUFHO1FBQ3pCLGFBQWE7UUFDYixPQUFPO1FBQ1AsYUFBYTtRQUNiLE9BQU87S0FDUCxDQUFDO0lBRUYsT0FBTyxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQVUsQ0FBQTtBQUNuQyxDQUFDO0FBakJELHdDQWlCQztBQUVELFNBQWdCLFlBQVksQ0FBTyxJQUFtQixFQUFFLE9BQWUsRUFBRSxJQUF5QjtJQUVqRyxPQUFPLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUE7QUFDeEUsQ0FBQztBQUhELG9DQUdDO0FBY0QsU0FBZ0IsZUFBZSxDQUFlLElBRzdDO0lBRUEsYUFBYTtJQUNiLElBQUksRUFBRSxPQUFPLEdBQUcsYUFBYSxFQUFFLE9BQU8sR0FBRyxhQUFhLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDO0lBQ3RFLElBQUksRUFBRSxRQUFRLEdBQUcsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDO0lBRS9CLElBQUksSUFBSSxHQUErQztRQUN0RCxHQUFJLElBQW1EO1FBQ3ZELGFBQWE7UUFDYixPQUFPO1FBQ1AsT0FBTztRQUNQLFFBQVE7S0FDUixDQUFDO0lBRUYsSUFBSSxPQUFtQyxDQUFDO0lBRXhDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFDMUI7UUFDQyxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFckIsY0FBYyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUUzQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQTtLQUN0RTtTQUVEO1FBQ0MsY0FBYyxDQUFDLE9BQWlCLENBQUMsR0FBRyxJQUFJLENBQUM7S0FDekM7SUFFRCxPQUFPLENBQUMsSUFBVyxDQUFDLENBQUM7SUFFckIsU0FBUyxPQUFPLENBQUMsSUFBaUI7UUFFakMsYUFBYTtRQUNiLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQztRQUNqQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDbEIsQ0FBQztJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2IsQ0FBQztBQTFDRCwwQ0EwQ0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgdXNlciBvbiAyMDE5LzUvMTcuXG4gKi9cblxuaW1wb3J0IHlhcmdzID0gcmVxdWlyZSgneWFyZ3MnKTtcbmltcG9ydCB7IEFyZ3VtZW50cywgQXJndiwgQ29tbWFuZEJ1aWxkZXIsIE9taXQgfSBmcm9tICd5YXJncyc7XG5cbmNvbnN0IGNhY2hlZF9jb21tYW5kOiBJQ2FjaGVkQ29tbW9uZCA9IHt9O1xuXG5leHBvcnQgY29uc3QgY2xpID0geWFyZ3Ncblx0Lm9wdGlvbignY3dkJywge1xuXHRcdGRlc2M6IGBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IG9yIHBhY2thZ2UgZGlyZWN0b3J5YCxcblx0XHRub3JtYWxpemU6IHRydWUsXG5cdFx0ZGVmYXVsdDogcHJvY2Vzcy5jd2QoKSxcblx0fSlcblx0Lm9wdGlvbignc2tpcENoZWNrV29ya3NwYWNlJywge1xuXHRcdGRlc2M6IGB0aGlzIG9wdGlvbnMgaXMgZm9yIHNlYXJjaCB5YXJuLmxvY2ssIHBrZyByb290LCB3b3Jrc3BhY2Ugcm9vdCwgbm90IHNhbWUgYXMgLS1pZ25vcmUtd29ya3NwYWNlLXJvb3QtY2hlY2tgLFxuXHRcdGJvb2xlYW46IHRydWUsXG5cdH0pXG5cdC5vcHRpb24oJ3l0LWRlYnVnLW1vZGUnLCB7XG5cdFx0Ym9vbGVhbjogdHJ1ZSxcblx0fSlcblx0LmNvbW1hbmQoe1xuXHRcdGNvbW1hbmQ6ICdoZWxwJyxcblx0XHRkZXNjcmliZTogJ1Nob3cgaGVscCcsXG5cdFx0YWxpYXNlczogWydoJ10sXG5cdFx0YnVpbGRlcih5YXJnKVxuXHRcdHtcblx0XHRcdHlhcmcuc2hvd0hlbHAoJ2xvZycpO1xuXHRcdFx0cmV0dXJuIHlhcmc7XG5cdFx0fSxcblx0XHRoYW5kbGVyOiBkdW1teV9oYW5kbGVyLFxuXHR9KVxuXHQuY29tbWFuZCh7XG5cdFx0Y29tbWFuZDogJ3ZlcnNpb24nLFxuXHRcdGRlc2NyaWJlOiAnU2hvdyB2ZXJzaW9uJyxcblx0XHRidWlsZGVyKHlhcmcpXG5cdFx0e1xuXHRcdFx0cmV0dXJuIHlhcmc7XG5cdFx0fSxcblx0XHRhc3luYyBoYW5kbGVyKClcblx0XHR7XG5cdFx0XHRyZXR1cm4gaW1wb3J0KCcuLi9wYWNrYWdlLmpzb24nKVxuXHRcdFx0XHQudGhlbih2ID0+IGNvbnNvbGUubG9nKHYudmVyc2lvbikpXG5cdFx0XHRcdDtcblx0XHR9LFxuXHR9KVxuXHQucmVjb21tZW5kQ29tbWFuZHMoKVxuO1xuXG5leHBvcnQgdHlwZSBJTXlZYXJnc0FyZ3YgPSB0eXBlb2YgY2xpO1xuXG5leHBvcnQgdHlwZSBJVW5wYWNrTXlZYXJnc0FyZ3YgPSB7XG5cdGN3ZDogc3RyaW5nO1xuXHRza2lwQ2hlY2tXb3Jrc3BhY2U6IGJvb2xlYW47XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0WWFyZ3MoKTogeWFyZ3MuQXJndjxJVW5wYWNrTXlZYXJnc0FyZ3Y+XG57XG5cdC8vIEB0cy1pZ25vcmVcblx0cmV0dXJuIGNsaTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xpXG5cbmV4cG9ydCB0eXBlIElVbnBhY2tZYXJnc0FyZ3Y8VCBleHRlbmRzIHlhcmdzLkFyZ3Y+ID0gVCBleHRlbmRzIHlhcmdzLkFyZ3Y8aW5mZXIgVT4gPyBVIDogbmV2ZXI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNhY2hlZENvbW1vbmRcbntcblx0W2NtZDogc3RyaW5nXTogeWFyZ3MuQ29tbWFuZE1vZHVsZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZHVtbXlfYnVpbGRlcjxUIGV4dGVuZHMge30+KHlhcmc6IHlhcmdzLkFyZ3Y8VD4pXG57XG5cdHJldHVybiB5YXJnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkdW1teV9oYW5kbGVyPFQgZXh0ZW5kcyB7fT4oYXJnczogeWFyZ3MuQXJndW1lbnRzPFQ+KTogYW55XG57XG5cdHJldHVybiBhcmdzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVfY29tbWFuZDxULCBVIGV4dGVuZHMgVD4oeWFyZzogeWFyZ3MuQXJndjxUPixcblx0Y29tbWFuZDogc3RyaW5nLFxuXHRoYW5kbGVyOiAoYXJnczogeWFyZ3MuQXJndW1lbnRzPFU+KSA9PiB2b2lkLFxuXHRidWlsZGVyPzogKHlhcmc6IHlhcmdzLkFyZ3Y8VD4pID0+IHlhcmdzLkFyZ3Y8VT4sXG4pXG57XG5cdC8vIEB0cy1pZ25vcmVcblx0YnVpbGRlciA9IGJ1aWxkZXIgfHwgZHVtbXlfYnVpbGRlcjtcblxuXHRjYWNoZWRfY29tbWFuZFtjb21tYW5kXSA9IHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0YnVpbGRlcixcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0aGFuZGxlcixcblx0fTtcblxuXHRyZXR1cm4gW2J1aWxkZXIsIGhhbmRsZXJdIGFzIGNvbnN0XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxsX2NvbW1vbmQ8VCwgVT4oeWFyZzogeWFyZ3MuQXJndjxUPiwgY29tbW9uZDogc3RyaW5nLCBhcmd2PzogeWFyZ3MuQXJndW1lbnRzPFU+KVxue1xuXHRyZXR1cm4gY2FjaGVkX2NvbW1hbmRbY29tbW9uZF0uaGFuZGxlcihhcmd2ID09IG51bGwgPyB5YXJnLmFyZ3YgOiBhcmd2KVxufVxuXG5leHBvcnQgdHlwZSBJQ29tbWFuZEJ1aWxkZXI8VCBleHRlbmRzIHt9LCBVIGV4dGVuZHMge30+ID0gKGFyZ3M6IHlhcmdzLkFyZ3Y8VD4pID0+IHlhcmdzLkFyZ3Y8SVVucGFja015WWFyZ3NBcmd2ICYgVT47XG5cbmV4cG9ydCB0eXBlIElDb21tYW5kTW9kdWxlPFQgZXh0ZW5kcyB7fSwgVSBleHRlbmRzIHt9ID0gSVVucGFja015WWFyZ3NBcmd2PiA9XG57XG5cdGNvbW1hbmQ/OiBSZWFkb25seUFycmF5PHN0cmluZz4gfCBzdHJpbmc7XG5cdGFsaWFzZXM/OiBSZWFkb25seUFycmF5PHN0cmluZz4gfCBzdHJpbmc7XG5cdGRlc2NyaWJlPzogc3RyaW5nIHwgZmFsc2U7XG5cblx0YnVpbGRlcj86IElDb21tYW5kQnVpbGRlcjxULCBVPixcblx0aGFuZGxlcihhcmdzOiB5YXJncy5Bcmd1bWVudHM8SVVucGFja015WWFyZ3NBcmd2ICYgVT4pOiBhbnksXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVfY29tbWFuZDI8VSBleHRlbmRzIHt9Pihjb25mOiBJQ29tbWFuZE1vZHVsZTxJVW5wYWNrTXlZYXJnc0FyZ3YsIFU+ICYge1xuXHQvL3lhcmc/OiB5YXJncy5Bcmd2PFQ+LFxuXHRkZXNjPzogSUNvbW1hbmRNb2R1bGU8SVVucGFja015WWFyZ3NBcmd2LCBVPltcImRlc2NyaWJlXCJdLFxufSk6IHlhcmdzLkNvbW1hbmRNb2R1bGU8SVVucGFja015WWFyZ3NBcmd2LCBVPlxue1xuXHQvLyBAdHMtaWdub3JlXG5cdGxldCB7IGhhbmRsZXIgPSBkdW1teV9oYW5kbGVyLCBidWlsZGVyID0gZHVtbXlfYnVpbGRlciwgZGVzYyB9ID0gY29uZjtcblx0bGV0IHsgZGVzY3JpYmUgPSBkZXNjIH0gPSBjb25mO1xuXG5cdGxldCBvcHRzOiB5YXJncy5Db21tYW5kTW9kdWxlPElVbnBhY2tNeVlhcmdzQXJndiwgVT4gPSB7XG5cdFx0Li4uKGNvbmYgYXMgeWFyZ3MuQ29tbWFuZE1vZHVsZTxJVW5wYWNrTXlZYXJnc0FyZ3YsIFU+KSxcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0YnVpbGRlcixcblx0XHRoYW5kbGVyLFxuXHRcdGRlc2NyaWJlLFxuXHR9O1xuXG5cdGxldCBjb21tYW5kOiByZWFkb25seSBzdHJpbmdbXSB8IHN0cmluZztcblxuXHRpZiAoQXJyYXkuaXNBcnJheShjb21tYW5kKSlcblx0e1xuXHRcdGxldCBjbWQgPSBjb21tYW5kWzBdO1xuXG5cdFx0Y2FjaGVkX2NvbW1hbmRbY21kXSA9IG9wdHM7XG5cblx0XHRjb21tYW5kLnNsaWNlKDEpLmZvckVhY2goYyA9PiBjYWNoZWRfY29tbWFuZFtjXSA9IGNhY2hlZF9jb21tYW5kW2NtZF0pXG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0Y2FjaGVkX2NvbW1hbmRbY29tbWFuZCBhcyBzdHJpbmddID0gb3B0cztcblx0fVxuXG5cdF9kZWxldGUob3B0cyBhcyBhbnkpO1xuXG5cdGZ1bmN0aW9uIF9kZWxldGUob3B0czogdHlwZW9mIGNvbmYpXG5cdHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0ZGVsZXRlIG9wdHMueWFyZztcblx0XHRkZWxldGUgb3B0cy5kZXNjO1xuXHR9XG5cblx0cmV0dXJuIG9wdHM7XG59XG4iXX0=