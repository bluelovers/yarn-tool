"use strict";
/**
 * Created by user on 2019/5/17.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const yargs = require("yargs");
const cached_command = {};
exports.cli = yargs
    .option('cwd', {
    desc: `current working directory or package directory`,
    normalize: true,
    default: process.cwd(),
})
    .option('skipCheckWorkspace', {
    desc: `this options is for search yarn.lock, pkg root, workspace root, not same as --ignore-workspace-root-check`,
    boolean: true,
})
    .command({
    command: 'help',
    describe: 'Show help',
    aliases: ['h'],
    builder(yarg) {
        yarg.showHelp('log');
        return yarg;
    },
    handler: dummy_handler,
})
    .command({
    command: 'version',
    describe: 'Show version',
    builder(yarg) {
        return yarg;
    },
    async handler() {
        return Promise.resolve().then(() => require('../package.json')).then(v => console.log(v.version));
    },
})
    .recommendCommands();
function getYargs() {
    // @ts-ignore
    return exports.cli;
}
exports.getYargs = getYargs;
exports.default = exports.cli;
function dummy_builder(yarg) {
    return yarg;
}
exports.dummy_builder = dummy_builder;
function dummy_handler(args) {
    return args;
}
exports.dummy_handler = dummy_handler;
function create_command(yarg, command, handler, builder) {
    // @ts-ignore
    builder = builder || dummy_builder;
    cached_command[command] = {
        // @ts-ignore
        builder,
        // @ts-ignore
        handler,
    };
    return [builder, handler];
}
exports.create_command = create_command;
function call_commond(yarg, commond, argv) {
    return cached_command[commond].handler(argv == null ? yarg.argv : argv);
}
exports.call_commond = call_commond;
function create_command2(conf) {
    // @ts-ignore
    let { handler = dummy_handler, builder = dummy_builder, desc } = conf;
    let { describe = desc } = conf;
    let opts = {
        ...conf,
        // @ts-ignore
        builder,
        handler,
        describe,
    };
    let command;
    if (Array.isArray(command)) {
        let cmd = command[0];
        cached_command[cmd] = opts;
        command.slice(1).forEach(c => cached_command[c] = cached_command[cmd]);
    }
    else {
        cached_command[command] = opts;
    }
    _delete(opts);
    function _delete(opts) {
        // @ts-ignore
        delete opts.yarg;
        delete opts.desc;
    }
    return opts;
}
exports.create_command2 = create_command2;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2xpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCwrQkFBZ0M7QUFHaEMsTUFBTSxjQUFjLEdBQW1CLEVBQUUsQ0FBQztBQUU3QixRQUFBLEdBQUcsR0FBRyxLQUFLO0tBQ3RCLE1BQU0sQ0FBQyxLQUFLLEVBQUU7SUFDZCxJQUFJLEVBQUUsZ0RBQWdEO0lBQ3RELFNBQVMsRUFBRSxJQUFJO0lBQ2YsT0FBTyxFQUFFLE9BQU8sQ0FBQyxHQUFHLEVBQUU7Q0FDdEIsQ0FBQztLQUNELE1BQU0sQ0FBQyxvQkFBb0IsRUFBRTtJQUM3QixJQUFJLEVBQUUsMkdBQTJHO0lBQ2pILE9BQU8sRUFBRSxJQUFJO0NBQ2IsQ0FBQztLQUNELE9BQU8sQ0FBQztJQUNSLE9BQU8sRUFBRSxNQUFNO0lBQ2YsUUFBUSxFQUFFLFdBQVc7SUFDckIsT0FBTyxFQUFFLENBQUMsR0FBRyxDQUFDO0lBQ2QsT0FBTyxDQUFDLElBQUk7UUFFWCxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3JCLE9BQU8sSUFBSSxDQUFDO0lBQ2IsQ0FBQztJQUNELE9BQU8sRUFBRSxhQUFhO0NBQ3RCLENBQUM7S0FDRCxPQUFPLENBQUM7SUFDUixPQUFPLEVBQUUsU0FBUztJQUNsQixRQUFRLEVBQUUsY0FBYztJQUN4QixPQUFPLENBQUMsSUFBSTtRQUVYLE9BQU8sSUFBSSxDQUFDO0lBQ2IsQ0FBQztJQUNELEtBQUssQ0FBQyxPQUFPO1FBRVosT0FBTyxxQ0FBTyxpQkFBaUIsR0FDN0IsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FDakM7SUFDSCxDQUFDO0NBQ0QsQ0FBQztLQUNELGlCQUFpQixFQUFFLENBQ3BCO0FBU0QsU0FBZ0IsUUFBUTtJQUV2QixhQUFhO0lBQ2IsT0FBTyxXQUFHLENBQUM7QUFDWixDQUFDO0FBSkQsNEJBSUM7QUFFRCxrQkFBZSxXQUFHLENBQUE7QUFTbEIsU0FBZ0IsYUFBYSxDQUFlLElBQW1CO0lBRTlELE9BQU8sSUFBSSxDQUFBO0FBQ1osQ0FBQztBQUhELHNDQUdDO0FBRUQsU0FBZ0IsYUFBYSxDQUFlLElBQXdCO0lBRW5FLE9BQU8sSUFBSSxDQUFBO0FBQ1osQ0FBQztBQUhELHNDQUdDO0FBRUQsU0FBZ0IsY0FBYyxDQUFpQixJQUFtQixFQUNqRSxPQUFlLEVBQ2YsT0FBMkMsRUFDM0MsT0FBZ0Q7SUFHaEQsYUFBYTtJQUNiLE9BQU8sR0FBRyxPQUFPLElBQUksYUFBYSxDQUFDO0lBRW5DLGNBQWMsQ0FBQyxPQUFPLENBQUMsR0FBRztRQUN6QixhQUFhO1FBQ2IsT0FBTztRQUNQLGFBQWE7UUFDYixPQUFPO0tBQ1AsQ0FBQztJQUVGLE9BQU8sQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFVLENBQUE7QUFDbkMsQ0FBQztBQWpCRCx3Q0FpQkM7QUFFRCxTQUFnQixZQUFZLENBQU8sSUFBbUIsRUFBRSxPQUFlLEVBQUUsSUFBeUI7SUFFakcsT0FBTyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ3hFLENBQUM7QUFIRCxvQ0FHQztBQWNELFNBQWdCLGVBQWUsQ0FBZSxJQUc3QztJQUVBLGFBQWE7SUFDYixJQUFJLEVBQUUsT0FBTyxHQUFHLGFBQWEsRUFBRSxPQUFPLEdBQUcsYUFBYSxFQUFFLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztJQUN0RSxJQUFJLEVBQUUsUUFBUSxHQUFHLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztJQUUvQixJQUFJLElBQUksR0FBK0M7UUFDdEQsR0FBSSxJQUFtRDtRQUN2RCxhQUFhO1FBQ2IsT0FBTztRQUNQLE9BQU87UUFDUCxRQUFRO0tBQ1IsQ0FBQztJQUVGLElBQUksT0FBbUMsQ0FBQztJQUV4QyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQzFCO1FBQ0MsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRXJCLGNBQWMsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUM7UUFFM0IsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7S0FDdEU7U0FFRDtRQUNDLGNBQWMsQ0FBQyxPQUFpQixDQUFDLEdBQUcsSUFBSSxDQUFDO0tBQ3pDO0lBRUQsT0FBTyxDQUFDLElBQVcsQ0FBQyxDQUFDO0lBRXJCLFNBQVMsT0FBTyxDQUFDLElBQWlCO1FBRWpDLGFBQWE7UUFDYixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDakIsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDO0lBQ2xCLENBQUM7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNiLENBQUM7QUExQ0QsMENBMENDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gMjAxOS81LzE3LlxuICovXG5cbmltcG9ydCB5YXJncyA9IHJlcXVpcmUoJ3lhcmdzJyk7XG5pbXBvcnQgeyBBcmd1bWVudHMsIEFyZ3YsIENvbW1hbmRCdWlsZGVyLCBPbWl0IH0gZnJvbSAneWFyZ3MnO1xuXG5jb25zdCBjYWNoZWRfY29tbWFuZDogSUNhY2hlZENvbW1vbmQgPSB7fTtcblxuZXhwb3J0IGNvbnN0IGNsaSA9IHlhcmdzXG5cdC5vcHRpb24oJ2N3ZCcsIHtcblx0XHRkZXNjOiBgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBvciBwYWNrYWdlIGRpcmVjdG9yeWAsXG5cdFx0bm9ybWFsaXplOiB0cnVlLFxuXHRcdGRlZmF1bHQ6IHByb2Nlc3MuY3dkKCksXG5cdH0pXG5cdC5vcHRpb24oJ3NraXBDaGVja1dvcmtzcGFjZScsIHtcblx0XHRkZXNjOiBgdGhpcyBvcHRpb25zIGlzIGZvciBzZWFyY2ggeWFybi5sb2NrLCBwa2cgcm9vdCwgd29ya3NwYWNlIHJvb3QsIG5vdCBzYW1lIGFzIC0taWdub3JlLXdvcmtzcGFjZS1yb290LWNoZWNrYCxcblx0XHRib29sZWFuOiB0cnVlLFxuXHR9KVxuXHQuY29tbWFuZCh7XG5cdFx0Y29tbWFuZDogJ2hlbHAnLFxuXHRcdGRlc2NyaWJlOiAnU2hvdyBoZWxwJyxcblx0XHRhbGlhc2VzOiBbJ2gnXSxcblx0XHRidWlsZGVyKHlhcmcpXG5cdFx0e1xuXHRcdFx0eWFyZy5zaG93SGVscCgnbG9nJyk7XG5cdFx0XHRyZXR1cm4geWFyZztcblx0XHR9LFxuXHRcdGhhbmRsZXI6IGR1bW15X2hhbmRsZXIsXG5cdH0pXG5cdC5jb21tYW5kKHtcblx0XHRjb21tYW5kOiAndmVyc2lvbicsXG5cdFx0ZGVzY3JpYmU6ICdTaG93IHZlcnNpb24nLFxuXHRcdGJ1aWxkZXIoeWFyZylcblx0XHR7XG5cdFx0XHRyZXR1cm4geWFyZztcblx0XHR9LFxuXHRcdGFzeW5jIGhhbmRsZXIoKVxuXHRcdHtcblx0XHRcdHJldHVybiBpbXBvcnQoJy4uL3BhY2thZ2UuanNvbicpXG5cdFx0XHRcdC50aGVuKHYgPT4gY29uc29sZS5sb2codi52ZXJzaW9uKSlcblx0XHRcdFx0O1xuXHRcdH0sXG5cdH0pXG5cdC5yZWNvbW1lbmRDb21tYW5kcygpXG47XG5cbmV4cG9ydCB0eXBlIElNeVlhcmdzQXJndiA9IHR5cGVvZiBjbGk7XG5cbmV4cG9ydCB0eXBlIElVbnBhY2tNeVlhcmdzQXJndiA9IHtcblx0Y3dkOiBzdHJpbmc7XG5cdHNraXBDaGVja1dvcmtzcGFjZTogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRZYXJncygpOiB5YXJncy5Bcmd2PElVbnBhY2tNeVlhcmdzQXJndj5cbntcblx0Ly8gQHRzLWlnbm9yZVxuXHRyZXR1cm4gY2xpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGlcblxuZXhwb3J0IHR5cGUgSVVucGFja1lhcmdzQXJndjxUIGV4dGVuZHMgeWFyZ3MuQXJndj4gPSBUIGV4dGVuZHMgeWFyZ3MuQXJndjxpbmZlciBVPiA/IFUgOiBuZXZlcjtcblxuZXhwb3J0IGludGVyZmFjZSBJQ2FjaGVkQ29tbW9uZFxue1xuXHRbY21kOiBzdHJpbmddOiB5YXJncy5Db21tYW5kTW9kdWxlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkdW1teV9idWlsZGVyPFQgZXh0ZW5kcyB7fT4oeWFyZzogeWFyZ3MuQXJndjxUPilcbntcblx0cmV0dXJuIHlhcmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGR1bW15X2hhbmRsZXI8VCBleHRlbmRzIHt9PihhcmdzOiB5YXJncy5Bcmd1bWVudHM8VD4pOiBhbnlcbntcblx0cmV0dXJuIGFyZ3Ncbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZV9jb21tYW5kPFQsIFUgZXh0ZW5kcyBUPih5YXJnOiB5YXJncy5Bcmd2PFQ+LFxuXHRjb21tYW5kOiBzdHJpbmcsXG5cdGhhbmRsZXI6IChhcmdzOiB5YXJncy5Bcmd1bWVudHM8VT4pID0+IHZvaWQsXG5cdGJ1aWxkZXI/OiAoeWFyZzogeWFyZ3MuQXJndjxUPikgPT4geWFyZ3MuQXJndjxVPixcbilcbntcblx0Ly8gQHRzLWlnbm9yZVxuXHRidWlsZGVyID0gYnVpbGRlciB8fCBkdW1teV9idWlsZGVyO1xuXG5cdGNhY2hlZF9jb21tYW5kW2NvbW1hbmRdID0ge1xuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRidWlsZGVyLFxuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRoYW5kbGVyLFxuXHR9O1xuXG5cdHJldHVybiBbYnVpbGRlciwgaGFuZGxlcl0gYXMgY29uc3Rcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGxfY29tbW9uZDxULCBVPih5YXJnOiB5YXJncy5Bcmd2PFQ+LCBjb21tb25kOiBzdHJpbmcsIGFyZ3Y/OiB5YXJncy5Bcmd1bWVudHM8VT4pXG57XG5cdHJldHVybiBjYWNoZWRfY29tbWFuZFtjb21tb25kXS5oYW5kbGVyKGFyZ3YgPT0gbnVsbCA/IHlhcmcuYXJndiA6IGFyZ3YpXG59XG5cbmV4cG9ydCB0eXBlIElDb21tYW5kQnVpbGRlcjxUIGV4dGVuZHMge30sIFUgZXh0ZW5kcyB7fT4gPSAoYXJnczogeWFyZ3MuQXJndjxUPikgPT4geWFyZ3MuQXJndjxJVW5wYWNrTXlZYXJnc0FyZ3YgJiBVPjtcblxuZXhwb3J0IHR5cGUgSUNvbW1hbmRNb2R1bGU8VCBleHRlbmRzIHt9LCBVIGV4dGVuZHMge30gPSBJVW5wYWNrTXlZYXJnc0FyZ3Y+ID1cbntcblx0Y29tbWFuZD86IFJlYWRvbmx5QXJyYXk8c3RyaW5nPiB8IHN0cmluZztcblx0YWxpYXNlcz86IFJlYWRvbmx5QXJyYXk8c3RyaW5nPiB8IHN0cmluZztcblx0ZGVzY3JpYmU/OiBzdHJpbmcgfCBmYWxzZTtcblxuXHRidWlsZGVyPzogSUNvbW1hbmRCdWlsZGVyPFQsIFU+LFxuXHRoYW5kbGVyKGFyZ3M6IHlhcmdzLkFyZ3VtZW50czxJVW5wYWNrTXlZYXJnc0FyZ3YgJiBVPik6IGFueSxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZV9jb21tYW5kMjxVIGV4dGVuZHMge30+KGNvbmY6IElDb21tYW5kTW9kdWxlPElVbnBhY2tNeVlhcmdzQXJndiwgVT4gJiB7XG5cdC8veWFyZz86IHlhcmdzLkFyZ3Y8VD4sXG5cdGRlc2M/OiBJQ29tbWFuZE1vZHVsZTxJVW5wYWNrTXlZYXJnc0FyZ3YsIFU+W1wiZGVzY3JpYmVcIl0sXG59KTogeWFyZ3MuQ29tbWFuZE1vZHVsZTxJVW5wYWNrTXlZYXJnc0FyZ3YsIFU+XG57XG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IHsgaGFuZGxlciA9IGR1bW15X2hhbmRsZXIsIGJ1aWxkZXIgPSBkdW1teV9idWlsZGVyLCBkZXNjIH0gPSBjb25mO1xuXHRsZXQgeyBkZXNjcmliZSA9IGRlc2MgfSA9IGNvbmY7XG5cblx0bGV0IG9wdHM6IHlhcmdzLkNvbW1hbmRNb2R1bGU8SVVucGFja015WWFyZ3NBcmd2LCBVPiA9IHtcblx0XHQuLi4oY29uZiBhcyB5YXJncy5Db21tYW5kTW9kdWxlPElVbnBhY2tNeVlhcmdzQXJndiwgVT4pLFxuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRidWlsZGVyLFxuXHRcdGhhbmRsZXIsXG5cdFx0ZGVzY3JpYmUsXG5cdH07XG5cblx0bGV0IGNvbW1hbmQ6IHJlYWRvbmx5IHN0cmluZ1tdIHwgc3RyaW5nO1xuXG5cdGlmIChBcnJheS5pc0FycmF5KGNvbW1hbmQpKVxuXHR7XG5cdFx0bGV0IGNtZCA9IGNvbW1hbmRbMF07XG5cblx0XHRjYWNoZWRfY29tbWFuZFtjbWRdID0gb3B0cztcblxuXHRcdGNvbW1hbmQuc2xpY2UoMSkuZm9yRWFjaChjID0+IGNhY2hlZF9jb21tYW5kW2NdID0gY2FjaGVkX2NvbW1hbmRbY21kXSlcblx0fVxuXHRlbHNlXG5cdHtcblx0XHRjYWNoZWRfY29tbWFuZFtjb21tYW5kIGFzIHN0cmluZ10gPSBvcHRzO1xuXHR9XG5cblx0X2RlbGV0ZShvcHRzIGFzIGFueSk7XG5cblx0ZnVuY3Rpb24gX2RlbGV0ZShvcHRzOiB0eXBlb2YgY29uZilcblx0e1xuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRkZWxldGUgb3B0cy55YXJnO1xuXHRcdGRlbGV0ZSBvcHRzLmRlc2M7XG5cdH1cblxuXHRyZXR1cm4gb3B0cztcbn1cbiJdfQ==